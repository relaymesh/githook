server:
  port: 8080

providers:
  github:
    enabled: true
    webhook:
      secret: ${GITHUB_WEBHOOK_SECRET}
    app:
      app_id: ${GITHUB_APP_ID}
      private_key_path: ${GITHUB_PRIVATE_KEY_PATH}
    api:
      base_url: https://api.github.com
  gitlab:
    enabled: false
    webhook:
      secret: ${GITLAB_WEBHOOK_SECRET}
    api:
      base_url: https://gitlab.com/api/v4
  bitbucket:
    enabled: false
    webhook:
      secret: ${BITBUCKET_WEBHOOK_SECRET}
    api:
      base_url: https://api.bitbucket.org/2.0

watermill:
  driver: sql
  sql:
    driver: sqlite
    dsn: ./data/watermill.db
    dialect: sqlite
    auto_initialize_schema: true

storage:
  driver: sqlite
  dsn: ./data/githooks.db
  dialect: sqlite
  auto_migrate: true

rules:
  - when: action == "opened" && pull_request.draft == false
    emit: pr.opened.ready

  - when: action == "closed" && pull_request.merged == true
    emit: pr.merged
